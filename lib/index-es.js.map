{"version":3,"file":"index-es.js","sources":["../src/util.ts","../src/index.ts"],"sourcesContent":["import type { NavigateURL, URLParams } from './typing';\n\n/**\n *\n * @param URL searchParams\n * @returns Object\n */\nexport const getQuery = (\n  searchParams: URLSearchParams,\n): Record<string, unknown> => {\n  const query = searchParams;\n  const keys = [...query.keys()];\n  const n = keys.length - 1;\n  // fast json\n  const res = keys.reduce((before, local, index) => {\n    const value = query.getAll(local);\n    // 非 number 、 string 类型时 需要加 引号\n    const next = `${before}\"${local}\":${\n      value.length > 1 ? `${JSON.stringify(value)}` : `\"${value[0]}\"`\n    }`;\n    return `${next}${index !== n ? ',' : ''}`;\n  }, '');\n  return JSON.parse(`{ ${res} }`) as Record<string, unknown>;\n};\n/**\n *\n * @param {String} url\n * @returns\n */\nconst formatURL = (url: string | URLParams) => {\n  let nextURL = '';\n  if (typeof url === 'string') {\n    if (!/^http[s]?:\\/\\//.test(url)) {\n      if (/^\\//.test(url)) {\n        nextURL = window.location.origin + url;\n      } else {\n        const path = window.location.pathname.split('/');\n        path.pop();\n        nextURL = window.location.origin + path.concat(url).join('/');\n      }\n    }\n  } else {\n    const { query, pathname = window.location.pathname } = url;\n    const search = new URLSearchParams();\n    const keys = Object.keys(query);\n    if (keys.length) {\n      keys.forEach((key) => {\n        const value = query[key];\n        // append will auto format value into string\n        search.append(key, value as string);\n      });\n      nextURL = `${pathname}?${search.toString()}`;\n    } else {\n      nextURL = pathname;\n    }\n    nextURL = window.location.origin + nextURL;\n  }\n  return nextURL;\n};\n\nexport const spreadURL = (url?: string | URLParams): NavigateURL => {\n  const nextUrl = url ? formatURL(url) : window.location.href;\n  const { host, origin, pathname, port, protocol, search, searchParams } =\n    new URL(nextUrl);\n  return {\n    query: getQuery(searchParams),\n    host,\n    origin,\n    pathname,\n    port,\n    protocol,\n    search,\n  };\n};\n","import { useState } from 'react';\n\nimport { spreadURL } from './util';\n\nconst useNavigate = () => {\n  const [route, setRoute] = useState(spreadURL);\n\n  const replace = (url: string) => {\n    try {\n      const nextURL = spreadURL(url);\n      const { pathname, search } = nextURL;\n      window.history.replaceState(new Date().valueOf(), '', pathname + search);\n      setRoute(nextURL);\n    } catch (e) {\n      console.error(`this is some error in ${JSON.stringify(e)}`);\n    }\n  };\n\n  const push = (url: string) => {\n    try {\n      const nextURL = spreadURL(url);\n      const { pathname, search } = nextURL;\n      window.history.pushState(new Date().valueOf(), '', pathname + search);\n      setRoute(nextURL);\n    } catch (e) {\n      console.error(`this is some error in ${JSON.stringify(e)}`);\n    }\n  };\n\n  const go = (number: unknown) => {\n    if (typeof number === 'number') {\n      window.history.go(number);\n    } else {\n      console.error(`${JSON.stringify(number)} is not number`);\n    }\n  };\n\n  const goBack = () => {\n    window.history.back();\n  };\n\n  return {\n    replace,\n    goBack,\n    push,\n    route,\n    go,\n  };\n};\n\nexport default useNavigate;\n"],"names":[],"mappings":";MAOa,WAAW,CACtB,iBAC4B;QACtB,QAAQ;QACR,OAAO,CAAC,GAAG,MAAM;QACjB,IAAI,KAAK,SAAS;QAElB,MAAM,KAAK,OAAO,CAAC,QAAQ,OAAO,UAAU;UAC1C,QAAQ,MAAM,OAAO;UAErB,OAAO,GAAG,UAAU,UACxB,MAAM,SAAS,IAAI,GAAG,KAAK,UAAU,WAAW,IAAI,MAAM;WAErD,GAAG,OAAO,UAAU,IAAI,MAAM;AAAA,KACpC;SACI,KAAK,MAAM,KAAK;AAAA;AAOzB,MAAM,YAAY,CAAC,QAA4B;MACzC,UAAU;MACV,OAAO,QAAQ,UAAU;QACvB,CAAC,iBAAiB,KAAK,MAAM;UAC3B,MAAM,KAAK,MAAM;kBACT,OAAO,SAAS,SAAS;AAAA,aAC9B;cACC,OAAO,OAAO,SAAS,SAAS,MAAM;aACvC;kBACK,OAAO,SAAS,SAAS,KAAK,OAAO,KAAK,KAAK;AAAA;AAAA;AAAA,SAGxD;UACC,EAAE,OAAO,WAAW,OAAO,SAAS,aAAa;UACjD,SAAS,IAAI;UACb,OAAO,OAAO,KAAK;QACrB,KAAK,QAAQ;WACV,QAAQ,CAAC,QAAQ;cACd,QAAQ,MAAM;eAEb,OAAO,KAAK;AAAA;gBAEX,GAAG,YAAY,OAAO;AAAA,WAC3B;gBACK;AAAA;cAEF,OAAO,SAAS,SAAS;AAAA;SAE9B;AAAA;MAGI,YAAY,CAAC,QAA0C;QAC5D,UAAU,MAAM,UAAU,OAAO,OAAO,SAAS;QACjD,EAAE,MAAM,QAAQ,UAAU,MAAM,UAAU,QAAQ,iBACtD,IAAI,IAAI;SACH;AAAA,IACL,OAAO,SAAS;AAAA,IAChB;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA;AAAA;MCnEE,cAAc,MAAM;QAClB,CAAC,OAAO,YAAY,SAAS;QAE7B,UAAU,CAAC,QAAgB;QAC3B;YACI,UAAU,UAAU;YACpB,EAAE,UAAU,WAAW;aACtB,QAAQ,aAAa,IAAI,OAAO,WAAW,IAAI,WAAW;eACxD;AAAA,aACF;cACC,MAAM,yBAAyB,KAAK,UAAU;AAAA;AAAA;QAIpD,OAAO,CAAC,QAAgB;QACxB;YACI,UAAU,UAAU;YACpB,EAAE,UAAU,WAAW;aACtB,QAAQ,UAAU,IAAI,OAAO,WAAW,IAAI,WAAW;eACrD;AAAA,aACF;cACC,MAAM,yBAAyB,KAAK,UAAU;AAAA;AAAA;QAIpD,KAAK,CAAC,WAAoB;QAC1B,OAAO,WAAW,UAAU;aACvB,QAAQ,GAAG;AAAA,WACb;cACG,MAAM,GAAG,KAAK,UAAU;AAAA;AAAA;QAI9B,SAAS,MAAM;WACZ,QAAQ;AAAA;SAGV;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA;AAAA;;"}