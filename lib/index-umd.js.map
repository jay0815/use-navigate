{"version":3,"file":"index-umd.js","sources":["../src/util.ts","../src/index.ts"],"sourcesContent":["import type { NavigateURL, URLParams } from './typing';\n\n/**\n *\n * @param URL searchParams\n * @returns Object\n */\nexport const getQuery = (\n  searchParams: URLSearchParams,\n): Record<string, unknown> => {\n  const query = searchParams;\n  const keys = [...query.keys()];\n  const n = keys.length - 1;\n  // fast json\n  const res = keys.reduce((before, local, index) => {\n    const value = query.getAll(local);\n    // 非 number 、 string 类型时 需要加 引号\n    const next = `${before}\"${local}\":${\n      value.length > 1 ? `${JSON.stringify(value)}` : `\"${value[0]}\"`\n    }`;\n    return `${next}${index !== n ? ',' : ''}`;\n  }, '');\n  return JSON.parse(`{ ${res} }`) as Record<string, unknown>;\n};\n/**\n *\n * @param {String} url\n * @returns\n */\nconst formatURL = (url: string | URLParams) => {\n  let nextURL = '';\n  if (typeof url === 'string') {\n    if (!/^http[s]?:\\/\\//.test(url)) {\n      if (/^\\//.test(url)) {\n        nextURL = window.location.origin + url;\n      } else {\n        const path = window.location.pathname.split('/');\n        path.pop();\n        nextURL = window.location.origin + path.concat(url).join('/');\n      }\n    }\n  } else {\n    const { query, pathname = window.location.pathname } = url;\n    const search = new URLSearchParams();\n    const keys = Object.keys(query);\n    if (keys.length) {\n      keys.forEach((key) => {\n        const value = query[key];\n        // append will auto format value into string\n        search.append(key, value as string);\n      });\n      nextURL = `${pathname}?${search.toString()}`;\n    } else {\n      nextURL = pathname;\n    }\n    nextURL = window.location.origin + nextURL;\n  }\n  return nextURL;\n};\n\nexport const spreadURL = (url?: string | URLParams): NavigateURL => {\n  const nextUrl = url ? formatURL(url) : window.location.href;\n  const { host, origin, pathname, port, protocol, search, searchParams } =\n    new URL(nextUrl);\n  return {\n    query: getQuery(searchParams),\n    host,\n    origin,\n    pathname,\n    port,\n    protocol,\n    search,\n  };\n};\n","import { useState } from 'react';\n\nimport { spreadURL } from './util';\n\nconst useNavigate = () => {\n  const [route, setRoute] = useState(spreadURL);\n\n  const replace = (url: string) => {\n    try {\n      const nextURL = spreadURL(url);\n      const { pathname, search } = nextURL;\n      window.history.replaceState(new Date().valueOf(), '', pathname + search);\n      setRoute(nextURL);\n    } catch (e) {\n      console.error(`this is some error in ${JSON.stringify(e)}`);\n    }\n  };\n\n  const push = (url: string) => {\n    try {\n      const nextURL = spreadURL(url);\n      const { pathname, search } = nextURL;\n      window.history.pushState(new Date().valueOf(), '', pathname + search);\n      setRoute(nextURL);\n    } catch (e) {\n      console.error(`this is some error in ${JSON.stringify(e)}`);\n    }\n  };\n\n  const go = (number: unknown) => {\n    if (typeof number === 'number') {\n      window.history.go(number);\n    } else {\n      console.error(`${JSON.stringify(number)} is not number`);\n    }\n  };\n\n  const goBack = () => {\n    window.history.back();\n  };\n\n  return {\n    replace,\n    goBack,\n    push,\n    route,\n    go,\n  };\n};\n\nexport default useNavigate;\n"],"names":["useState"],"mappings":"qRAOa,GAAW,AACtB,GAC4B,MACtB,GAAQ,EACR,EAAO,CAAC,GAAG,EAAM,QACjB,EAAI,EAAK,OAAS,EAElB,EAAM,EAAK,OAAO,CAAC,EAAQ,EAAO,IAAU,MAC1C,GAAQ,EAAM,OAAO,SAKpB,GAHM,GAAG,KAAU,MACxB,EAAM,OAAS,EAAI,GAAG,KAAK,UAAU,KAAW,IAAI,EAAM,UAE3C,IAAU,EAAI,IAAM,MACpC,UACI,MAAK,MAAM,KAAK,QAOnB,EAAY,AAAC,GAA4B,IACzC,GAAU,MACV,MAAO,IAAQ,aACb,CAAC,iBAAiB,KAAK,MACrB,MAAM,KAAK,KACH,OAAO,SAAS,OAAS,MAC9B,MACC,GAAO,OAAO,SAAS,SAAS,MAAM,OACvC,QACK,OAAO,SAAS,OAAS,EAAK,OAAO,GAAK,KAAK,UAGxD,MACC,CAAE,QAAO,WAAW,OAAO,SAAS,UAAa,EACjD,EAAS,GAAI,iBACb,EAAO,OAAO,KAAK,GACrB,EAAK,UACF,QAAQ,AAAC,GAAQ,MACd,GAAQ,EAAM,KAEb,OAAO,EAAK,OAEX,GAAG,KAAY,EAAO,gBAEtB,IAEF,OAAO,SAAS,OAAS,QAE9B,IAGI,EAAY,AAAC,GAA0C,MAC5D,GAAU,EAAM,EAAU,GAAO,OAAO,SAAS,KACjD,CAAE,OAAM,SAAQ,WAAU,OAAM,WAAU,SAAQ,gBACtD,GAAI,KAAI,SACH,CACL,MAAO,EAAS,GAChB,OACA,SACA,WACA,OACA,WACA,iBCnEgB,IAAM,MAClB,CAAC,EAAO,GAAYA,WAAS,SAoC5B,CACL,QAnCc,AAAC,GAAgB,IAC3B,MACI,GAAU,EAAU,GACpB,CAAE,WAAU,UAAW,SACtB,QAAQ,aAAa,GAAI,QAAO,UAAW,GAAI,EAAW,KACxD,SACF,WACC,MAAM,yBAAyB,KAAK,UAAU,QA6BxD,OANa,IAAM,QACZ,QAAQ,QAMf,KA1BW,AAAC,GAAgB,IACxB,MACI,GAAU,EAAU,GACpB,CAAE,WAAU,UAAW,SACtB,QAAQ,UAAU,GAAI,QAAO,UAAW,GAAI,EAAW,KACrD,SACF,WACC,MAAM,yBAAyB,KAAK,UAAU,QAoBxD,QACA,GAjBS,AAAC,GAAoB,CAC1B,MAAO,IAAW,gBACb,QAAQ,GAAG,WAEV,MAAM,GAAG,KAAK,UAAU"}